<!DOCTYPE html>
<html>
<head>
  <title>Persist.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "home/fozz/Projects/syncit//Queue/Persist.js", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h2">
        <a href="#queue">Queue</a>
      </div>
      <div class="heading h3">
        <a href="#new%20queue()">new Queue()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h4">
        <a href="#see">See</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getfullqueue()">Queue.getFullQueue()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getitemsfordatasetanddatakey()">Queue.getItemsForDatasetAndDatakey()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getdatakeyindataset()">Queue.getDatakeyInDataset()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue._getqueue()">Queue._getQueue()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getcountinqueue()">Queue.getCountInQueue()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue._removebydatasetanddatakey">Queue._removeByDatasetAndDatakey</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.push()">Queue.push()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.advance()">Queue.advance()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getfirst()">Queue.getFirst()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
      <div class="heading h3">
        <a href="#queue.getdatasetnames()">Queue.getDatasetNames()</a>
      </div>
      <div class="heading h4">
        <a href="#parameters">Parameters</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>Persist.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="cm">/*jshint smarttabs:true */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// UMD from https://github.com/umdjs/umd/blob/master/returnExports.js</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span>
      <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../Constant.js&#39;</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">define</span><span class="p">(</span>
      <span class="p">[</span><span class="s1">&#39;syncit/Constant&#39;</span><span class="p">],</span>
      <span class="nx">factory</span>
    <span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">SyncIt_Queue_Persist</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span>
      <span class="nx">root</span><span class="p">.</span><span class="nx">SyncIt_Constant</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">})(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">SyncIt_Constant</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Author: Matthew Forrester <matt_at_keyboardwritescode.com>
Copyright: Matthew Forrester
License: MIT/BSD-style</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">_filter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span><span class="nx">filterFunc</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">filterFunc</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue">
  <h2>
    <a href="#queue" name="queue" class="pilcrow">&#182;</a>
    Queue
  </h2>
</div>

  </div>
  <div class="body"><p><em>Queue</em> stores <em>operation</em>s which have been performed locally but are still waiting to
be applied to the <em>Server</em>.</p>

<p>Currently Queue is a bit basic in that it stores a giant array in the key <code>_queue</code> instead of storing them seperately. This is fine for Persists that use Memory and I have seen people saying that is the fastest way to use LocalStorage (though I wonder if it's size dependant). Still I do feel this is a bit of an overly basic implementation. I expect to improve this soon.</p>

<p>Note: All <em>Queue</em> must support at least the <em>Dataset</em> and <em>Datakey</em> filters. This class only supports those.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="new%20queue()">
  <h3>
    <a href="#new%20queue()" name="new%20queue()" class="pilcrow">&#182;</a>
    new Queue()
  </h3>
</div>

  </div>
  <div class="body">
<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Persist} <code>persist</code></strong></li>
</ul>


<div class="pilwrap" id="see">
  <h4>
    <a href="#see" name="see" class="pilcrow">&#182;</a>
    See
  </h4>
</div>


<p>See <a href="Persist.js">Persist</a> for more information</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">Queue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">persist</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_persist</span> <span class="o">=</span> <span class="nx">persist</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Queue._basicFilterMethod()</p>
  </div>
  <div class="body"><p>Filter out items based on a <em>Dataset</em> and <em>Datakey</em>.</p>

<p>Parameters</p>

<ul>
<li><strong>@param {Object} <code>filter</code></strong> Takes an Object like <code>{dataset: 'dataset_name', datakey: 'datakey_name</code>'} to filter by <em>Dataset</em> and <em>Datakey</em>.</li>
<li><strong>@param {Array} <code>queueitems</code></strong> An array of <em>Queueitem</em> to filter.</li>
<li><strong>@return {Array}</strong> The <em>Queueitem</em> that passed the filter.</li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_basicFilterMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">filter</span><span class="p">,</span> <span class="nx">queueitems</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
  
  <span class="kd">var</span> <span class="nx">filterFunc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">queueitem</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;dataset&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">queueitem</span><span class="p">.</span><span class="nx">s</span> <span class="o">!==</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">dataset</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;datakey&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">queueitem</span><span class="p">.</span><span class="nx">k</span> <span class="o">!==</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">datakey</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">};</span>
  
  <span class="kd">var</span> <span class="nx">propertyNames</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ob</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">ob</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">ob</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">k</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
    <span class="p">}</span> <span class="p">}</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
  <span class="p">})(</span><span class="nx">filter</span><span class="p">);</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">propertyNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">propertyNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;dataset&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">propertyNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;datakey&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="s2">&quot;Queue._basicFilterMethod: Can only filter on dataset and datakey&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">queueitems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span> <span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">filterFunc</span><span class="p">(</span><span class="nx">queueitems</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">queueitems</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue.getfullqueue()">
  <h3>
    <a href="#queue.getfullqueue()" name="queue.getfullqueue()" class="pilcrow">&#182;</a>
    Queue.getFullQueue()
  </h3>
</div>

  </div>
  <div class="body"><p>Gets all items from the Queue.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Function} <code>callback</code></strong> To get the results. Signature <code>function(err, results)</code>.
<ul><li><strong>@param {ErrorCode} <code>callback.err</code></strong> See SyncIt_Constant.Error.</li>
<li><strong>@param {Array} <code>callback.results</code></strong> An array of <code>queueitem</code></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFullQueue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="nx">callback</span><span class="p">);</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue.getitemsfordatasetanddatakey()">
  <h3>
    <a href="#queue.getitemsfordatasetanddatakey()" name="queue.getitemsfordatasetanddatakey()" class="pilcrow">&#182;</a>
    Queue.getItemsForDatasetAndDatakey()
  </h3>
</div>

  </div>
  <div class="body"><p>Gets the items from the Queue which match both the Dataset and Datakey.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {String} <code>dataset</code></strong></li>
<li><strong>@param {String} <code>datakey</code></strong></li>
<li><strong>@param {Function} <code>callback</code></strong> To get the results. Signature <code>function(err, results)</code>.
<ul><li><strong>@param {ErrorCode} <code>callback.err</code></strong> See SyncIt_Constant.Error.</li>
<li><strong>@param {Array} <code>callback.results</code></strong> An array of <code>queueitem</code></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getItemsForDatasetAndDatakey</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="nx">datakey</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({</span><span class="nx">dataset</span><span class="o">:</span> <span class="nx">dataset</span><span class="p">,</span> <span class="nx">datakey</span><span class="o">:</span> <span class="nx">datakey</span><span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue.getdatakeyindataset()">
  <h3>
    <a href="#queue.getdatakeyindataset()" name="queue.getdatakeyindataset()" class="pilcrow">&#182;</a>
    Queue.getDatakeyInDataset()
  </h3>
</div>

  </div>
  <div class="body"><p>List all the Datakeys from a specific Dataset</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {String} <code>dataset</code></strong></li>
<li><strong>@param {Function} <code>callback</code></strong> To get the results. Signature <code>function(err, results)</code>.
<ul><li><strong>@param {ErrorCode} <code>callback.err</code></strong> See SyncIt_Constant.Error.</li>
<li><strong>@param {Array} <code>callback.results</code></strong> An array of Datakey</li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDatakeyInDataset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({</span><span class="nx">dataset</span><span class="o">:</span> <span class="nx">dataset</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">queueitems</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">queueitems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">queueitems</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">k</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">r</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue._getqueue()">
  <h3>
    <a href="#queue._getqueue()" name="queue._getqueue()" class="pilcrow">&#182;</a>
    Queue._getQueue()
  </h3>
</div>

  </div>
  <div class="body"><p>Gets the items from the Queue, respecting the supplied filter</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Object} <code>filter</code></strong> Filtering parameters. See <a href="#queue._basicfiltermethod--">basic filtering method</a></li>
<li><strong>@param {Function} <code>callback</code></strong> To get the results. Signature <code>function(err, results)</code>.
<ul><li><strong>@param {ErrorCode} <code>callback.err</code></strong> See SyncIt_Constant.Error.</li>
<li><strong>@param {Array} <code>callback.results</code></strong> An array of <code>queueitem</code></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_getQueue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">filter</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_persist</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;_queue&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">queueitems</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="o">==</span> <span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">NO_DATA_FOUND</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">queueitems</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">err</span> <span class="o">=</span> <span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">OK</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="o">!==</span> <span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">OK</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="nx">callback</span><span class="p">(</span>
      <span class="nx">err</span><span class="p">,</span>
      <span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_basicFilterMethod</span><span class="p">(</span><span class="nx">filter</span><span class="p">,</span> <span class="nx">queueitems</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>Queue._setQueue()</strong></p>
  </div>
  <div class="body"><p><strong>Parameters</strong></p>

<ul>
<li><strong>@param {Array} <code>queueitem</code></strong> The new <code>Queueitem</code>s</li>
<li><strong>@param {Function} <code>callback</code></strong> Called when done</li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_setQueue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">queueitem</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_persist</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span>
    <span class="s1">&#39;_queue&#39;</span><span class="p">,</span>
    <span class="nx">queueitem</span><span class="p">,</span>
    <span class="nx">callback</span>
  <span class="p">);</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
  </div>
  <div class="body">
<div class="pilwrap" id="queue.getcountinqueue()">
  <h3>
    <a href="#queue.getcountinqueue()" name="queue.getcountinqueue()" class="pilcrow">&#182;</a>
    Queue.getCountInQueue()
  </h3>
</div>


<p>Gets the count of items matching a Filter in the <em>Queue</em>.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Function} <code>retrieved</code></strong> Called when count retrieved. Signature: <code>function(err, length)</code>
<ul><li><strong>@param {ErrorCode} <code>retrieved.err</code></strong></li>
<li><strong>@param {Number} <code>retrieved.length</code></strong> The amount of items in the list matching the filter</li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getCountInQueue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">retrieved</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="o">!==</span> <span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">OK</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">retrieved</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">retrieved</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue._removebydatasetanddatakey">
  <h3>
    <a href="#queue._removebydatasetanddatakey" name="queue._removebydatasetanddatakey" class="pilcrow">&#182;</a>
    Queue._removeByDatasetAndDatakey
  </h3>
</div>

  </div>
  <div class="body"><p>Removes all <em>Queueitem</em> that have a specified <em>Dataset</em> and <em>Datakey</em>.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {String} <code>dataset</code></strong></li>
<li><strong>@param {String} <code>datakey</code></strong></li>
<li><strong>@param {String} <code>whenRemoved</code></strong> Called when done. Signature: <code>function(err)</code>
<ul><li><strong>@param {ErrorCode} <code>whenRemoved.err</code></strong></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_removeByDatasetAndDatakey</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dataset</span><span class="p">,</span> <span class="nx">datakey</span><span class="p">,</span> <span class="nx">whenRemoved</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">inst</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="o">==</span> <span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">NO_DATA_FOUND</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">whenRemoved</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">_setQueue</span><span class="p">(</span>
      <span class="nx">_filter</span><span class="p">(</span><span class="nx">queue</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span>
          <span class="p">(</span><span class="nx">update</span><span class="p">.</span><span class="nx">s</span> <span class="o">==</span> <span class="nx">dataset</span><span class="p">)</span> <span class="o">&amp;&amp;</span> 
          <span class="p">(</span><span class="nx">update</span><span class="p">.</span><span class="nx">k</span> <span class="o">==</span> <span class="nx">datakey</span><span class="p">)</span>
        <span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}),</span>
      <span class="nx">whenRemoved</span>
    <span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="queue.push()">
  <h3>
    <a href="#queue.push()" name="queue.push()" class="pilcrow">&#182;</a>
    Queue.push()
  </h3>
</div>

  </div>
  <div class="body"><p>Add an item onto the end of the <em>Queue</em>.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {queueitem} <code>value</code></strong></li>
<li><strong>@param {Function} <code>whenAddedAtEnd</code></strong> Called when added, Signature: <code>function(err)</code>
<ul><li><strong>@param {ErrorCode} <code>whenAddedAtEnd.err</code></strong></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">whenAddedAtEnd</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">inst</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">whenAddedAtEnd</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">_setQueue</span><span class="p">(</span><span class="nx">queue</span><span class="p">,</span> <span class="nx">whenAddedAtEnd</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
  </div>
  <div class="body">
<div class="pilwrap" id="queue.advance()">
  <h3>
    <a href="#queue.advance()" name="queue.advance()" class="pilcrow">&#182;</a>
    Queue.advance()
  </h3>
</div>


<p>Remove the first value from the <em>Queue</em>, like <code>Array.shift()</code> except it does not
return the removed item.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Function} <code>done</code></strong> Called when complete. Signature: <code>function(err)</code>
<ul><li><strong>@param {ErrorCode} <code>done.err</code></strong></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">advance</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">inst</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">queue</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">_setQueue</span><span class="p">(</span><span class="nx">queue</span><span class="p">,</span> <span class="nx">done</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
  </div>
  <div class="body">
<div class="pilwrap" id="queue.getfirst()">
  <h3>
    <a href="#queue.getfirst()" name="queue.getfirst()" class="pilcrow">&#182;</a>
    Queue.getFirst()
  </h3>
</div>


<p>Gets the first item in the <em>Queue</em>.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Function} <code>whenFirstElementRetrieved</code></strong> Called when got. Signature: <code>function(err, queueitem)</code>
<ul><li><strong>@param {ErrorCode} <code>whenFirstElementRetrieved.err</code></strong></li>
<li><strong>@param {Queueitem} <code>whenFirstElementRetrieved.queueitem</code></strong></li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFirst</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">whenFirstElementRetrieved</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">queue</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">whenFirstElementRetrieved</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">queue</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">whenFirstElementRetrieved</span><span class="p">(</span><span class="nx">SyncIt_Constant</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">NO_DATA_FOUND</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
  </div>
  <div class="body">
<div class="pilwrap" id="queue.getdatasetnames()">
  <h3>
    <a href="#queue.getdatasetnames()" name="queue.getdatasetnames()" class="pilcrow">&#182;</a>
    Queue.getDatasetNames()
  </h3>
</div>


<p>Gets the names of <em>Dataset</em> within the <em>Queue</em>.</p>


<div class="pilwrap" id="parameters">
  <h4>
    <a href="#parameters" name="parameters" class="pilcrow">&#182;</a>
    Parameters
  </h4>
</div>


<ul>
<li><strong>@param {Function} <code>whenRetrieved</code></strong> Called when got. Signature: <code>function(err, datasets)</code>.
<ul><li><strong>@param {ErrorCode} <code>whenRetrieved.err</code></strong></li>
<li><strong>@param {Array} <code>whenRetrieved.datasets</code></strong> An array of Dataset names.</li></ul></li>
</ul>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Queue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDatasetNames</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">whenRetrieved</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_getQueue</span><span class="p">({},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">queue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">whenRetrieved</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">r</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">queue</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">r</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">queue</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">s</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">queue</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">s</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">whenRetrieved</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="k">return</span> <span class="nx">Queue</span><span class="p">;</span>

<span class="p">});</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
